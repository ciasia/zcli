name: publish

on:
  push:
    branches: test_protected

jobs:
  main:
    runs-on: ubuntu-latest
    steps:
    - uses: zendesk/checkout@v2
    - uses: zendesk/setup-node@v2.1.2
      with:
        node-version: '12.x'
    - name: publish_on_merge
      run: |
        git config user.name github-actions
        git config user.email github-actions@github.com
        mkdir ~/.ssh
        echo "${{ secrets.AUTOMATED_RELEASE_WRITE_KEY }}" > ~/.ssh/id_rsa
        chmod 600 ~/.ssh/id_rsa
        cat ~/.ssh/id_rsa
        echo "some text1" >> README.md
        git status
        git add .
        git commit -m "test commit"
        git push
        
